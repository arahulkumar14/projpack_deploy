pipeline {
    agent any

    stages {
        stage('Connection Check') {
            steps {
                sh '''
                    echo "Checking Connectivity !"
                    pwd
                    echo "Connection Established"
                '''
            }
        }
        stage('Build Package') {
            steps {
                echo 'Starting Package Creation'
                sh '''
                 cd /opt/Axway-7.7.0/apigateway/posix/bin
                 pwd
                ./projpack --create --dir=/jenagent/workspace/proj_pack_deployment --passphrase-none --name=deploymentpackage --type=fed --add /jenagent/workspace/proj_pack_deployment/cfd17dd7-0637-438a-8d97-a8d522d8fd44 --projpass-none
                echo 'Package Creation Completed'
                '''
            }
        }
        stage('Deploy') {
            steps {
                echo 'Starting Deployment'
                  sh '''
                cd /opt/Axway-7.7.0/apigateway/posix/bin
                ./projdeploy --dir=/jenagent/workspace/proj_pack_deployment --passphrase-none --name=deploymentpackage --type=fed --deploy-to --host-name=10.128.150.82 --port=8090 --user-name=admin --password=changeme --group-name=mygroup --includes server-1
                 echo "Deployment Completed!"
                 '''
            }
        }
    }
}
