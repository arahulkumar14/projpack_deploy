pipeline {
    agent any

    stages {
        stage('Connection Check') {
            steps {
                sh '''
                    echo "Checking Connectivity !"
                    pwd
                    echo "Connection Established"
                '''
            }
        }
		if ( ${Please select type of deployment} == "With .fed file - Only Deployment") {
        stage('Deploy .fed package') {    
           steps {
                echo 'Starting Deployment'
                sh '''
                 cd /opt/Axway-7.7.0/apigateway/posix/bin
                 pwd
                ./projdeploy --dir=/jenagent/workspace/proj_pack_deployment --passphrase-none --name=deploypackage --type=fed --deploy-to --host-name=10.128.150.82 --port=8090 --user-name=admin --password=changeme --group-name=mygroup --includes server-1
                echo 'Deployment Completed'
                '''
             } } }
            else{
                stage('Build Package') {    
			steps {
                echo 'Starting Package Creation'
                sh '''
                 cd /opt/Axway-7.7.0/apigateway/posix/bin
                 pwd
                ./projpack --create --dir=/jenagent/workspace/proj_pack_deployment --passphrase-none --name=deploymentpackage --type=fed --add /jenagent/workspace/proj_pack_deployment/cfd17dd7-0637-438a-8d97-a8d522d8fd44 --projpass-none
				echo "Starting Deployment"
				./projdeploy --dir=/jenagent/workspace/proj_pack_deployment --passphrase-none --name=deploymentpackage --type=fed --deploy-to --host-name=10.128.150.82 --port=8090 --user-name=admin --password=changeme --group-name=mygroup --includes server-1
                echo 'Package Creation Completed'
                '''
             } } }
        stage('Deploy') {
            steps {
				echo "Deployment Completed!"

            }
        }
	   
    }
    
}
